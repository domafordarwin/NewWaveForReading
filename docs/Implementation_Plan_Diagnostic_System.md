# μ§„λ‹¨ ν‰κ°€ μ‹μ¤ν… κµ¬ν„ κ³„νμ„

## 1. ν”„λ΅μ νΈ κ°μ”

### 1.1 λ©ν‘
λ…μ„ λ¥λ ¥ μ§„λ‹¨ ν‰κ°€ μ‹μ¤ν… κµ¬μ¶• - ν‰κ°€ μƒμ„±, μ‘μ‹, μ±„μ , λ³΄κ³ μ„ μƒμ„±κΉμ§€ μ „μ²΄ ν”„λ΅μ„Έμ¤ μλ™ν™”

### 1.2 κΈ°κ°„
μ•½ 4-6μ£Ό (λ‹¨κ³„λ³„ μμ°¨ μ§„ν–‰)

### 1.3 μ°μ„ μμ„
1. **P0 (ν•„μ)**: MVP κΈ°λ¥ - μ§„λ‹¨ ν‰κ°€ μƒμ„±, μ‘μ‹, μ±„μ , κΈ°λ³Έ λ³΄κ³ μ„
2. **P1 (μ¤‘μ”)**: κ³ κΈ‰ κΈ°λ¥ - μƒμ„Έ λ¶„μ„, ν•™μµ μ¶”μ²
3. **P2 (μ„ νƒ)**: λ¶€κ°€ κΈ°λ¥ - PDF λ‚΄λ³΄λ‚΄κΈ°, μ„±μ¥ μ¶”μ 

---

## 2. λ‹¨κ³„λ³„ κµ¬ν„ κ³„ν

### Phase 1: λ°μ΄ν„°λ² μ΄μ¤ λ° κΈ°λ³Έ μΈν”„λΌ (1μ£Όμ°¨)

#### 1.1 λ°μ΄ν„°λ² μ΄μ¤ μ¤ν‚¤λ§ κµ¬μ¶•
**μ‘μ—… λ‚΄μ©**:
- μ‹ κ· ν…μ΄λΈ” μƒμ„± SQL μ‘μ„±
- RLS μ •μ±… μ„¤μ •
- μΈλ±μ¤ μµμ ν™”

**νμΌ**:
- `supabase/diagnostic_assessment_schema.sql`

**ν…μ΄λΈ” λ©λ΅**:
```sql
1. diagnostic_assessments       -- μ§„λ‹¨ ν‰κ°€ κΈ°λ³Έ μ •λ³΄
2. assessment_items             -- ν‰κ°€-λ¬Έν•­ μ—°κ²°
3. assessment_attempts          -- ν•™μƒ μ‘μ‹ κΈ°λ΅
4. student_responses            -- ν•™μƒ λ‹µμ•
5. essay_gradings               -- μ„μ ν• μ±„μ  μƒμ„Έ
6. diagnostic_reports           -- μ§„λ‹¨ λ³΄κ³ μ„
```

**κ²€μ¦**:
- [ ] λ¨λ“  ν…μ΄λΈ” μƒμ„± μ™„λ£
- [ ] μ™Έλν‚¤ μ μ•½μ΅°κ±΄ λ™μ‘ ν™•μΈ
- [ ] RLS μ •μ±… ν…μ¤νΈ
- [ ] κΈ°λ³Έ λ°μ΄ν„° INSERT ν…μ¤νΈ

---

#### 1.2 Supabase νƒ€μ… μ •μ
**μ‘μ—… λ‚΄μ©**:
- TypeScript νƒ€μ… μ •μ νμΌ μƒμ„±
- Supabase ν΄λΌμ΄μ–ΈνΈ ν—¬νΌ ν•¨μ μ‘μ„±

**νμΌ**:
- `frontend/src/types/diagnosticAssessment.ts`
- `frontend/src/services/diagnosticAssessmentService.ts`

**μΈν„°νμ΄μ¤ λ©λ΅**:
```typescript
- DiagnosticAssessment
- AssessmentItem
- AssessmentAttempt
- StudentResponse
- EssayGrading
- DiagnosticReport
```

**κ²€μ¦**:
- [ ] TypeScript μ»΄νμΌ μ—λ¬ μ—†μ
- [ ] νƒ€μ… μ •μμ™€ DB μ¤ν‚¤λ§ μΌμΉ ν™•μΈ

---

### Phase 2: μ§„λ‹¨ ν‰κ°€ μƒμ„± κΈ°λ¥ (1μ£Όμ°¨)

#### 2.1 Backend API κµ¬ν„
**μ‘μ—… λ‚΄μ©**:
- μ§„λ‹¨ ν‰κ°€ CRUD API
- λ¬Έν•­ μ„ νƒ λ° μ¶”κ°€ API
- ν‰κ°€ λ°°ν¬ API

**νμΌ**:
- `frontend/src/services/diagnosticAssessmentService.ts`

**μ£Όμ” ν•¨μ**:
```typescript
- createDiagnosticAssessment()
- getDiagnosticAssessments()
- updateDiagnosticAssessment()
- deleteDiagnosticAssessment()
- addItemsToAssessment()
- publishAssessment()
```

**κ²€μ¦**:
- [ ] ν‰κ°€ μƒμ„±/μμ •/μ‚­μ  μ„±κ³µ
- [ ] λ¬Έν•­ μ¶”κ°€/μ κ±° μ„±κ³µ
- [ ] μƒνƒ λ³€κ²½ (draft β†’ published) μ„±κ³µ

---

#### 2.2 μ§„λ‹¨ ν‰κ°€ μƒμ„± UI
**μ‘μ—… λ‚΄μ©**:
- ν‰κ°€ κΈ°λ³Έ μ •λ³΄ μ…λ ¥ νΌ
- λ¬Έν•­ μ€ν–‰μ—μ„ λ¬Έν•­ μ„ νƒ
- μ„ νƒλ λ¬Έν•­ λ©λ΅ κ΄€λ¦¬ (μμ„ μ΅°μ •, λ°°μ  μ„¤μ •)

**νμΌ**:
- `frontend/src/pages/DiagnosticAssessmentCreate.tsx`
- `frontend/src/components/ItemSelector.tsx`
- `frontend/src/components/SelectedItemsList.tsx`

**ν™”λ©΄ κµ¬μ„±**:
```
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚  μ§„λ‹¨ ν‰κ°€ μƒμ„±                                      β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚  ν‰κ°€λ…: [_____________]                             β”‚
β”‚  ν•™λ…„κµ°: [μ΄μ €β–Ό]  ν‰κ°€ μ ν•: [μ§„λ‹¨β–Ό]                β”‚
β”‚  μ ν•μ‹κ°„: [60] λ¶„                                   β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚  λ¬Έν•­ μ„ νƒ (λ¬Έν•­ μ€ν–‰)          μ„ νƒλ λ¬Έν•­ (5κ°)    β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”          β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β” β”‚
β”‚  β”‚ κ²€μƒ‰: [____]     β”‚          β”‚ 1. [λ¬Έν•­1]  10μ  β”‚ β”‚
β”‚  β”‚ ν•„ν„°: μμ—­, λ‚μ΄λ„β”‚          β”‚ 2. [λ¬Έν•­2]  15μ  β”‚ β”‚
β”‚  β”‚                  β”‚          β”‚ 3. [λ¬Έν•­3]  10μ  β”‚ β”‚
β”‚  β”‚ [λ¬Έν•­ λ©λ΅]      β”‚          β”‚ 4. [λ¬Έν•­4]  15μ  β”‚ β”‚
β”‚  β”‚  β–΅ λ¬Έν•­1  [μ¶”κ°€] β”‚          β”‚ 5. [λ¬Έν•­5]  20μ  β”‚ β”‚
β”‚  β”‚  β–΅ λ¬Έν•­2  [μ¶”κ°€] β”‚          β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β” β”‚
β”‚  β”‚  β–΅ λ¬Έν•­3  [μ¶”κ°€] β”‚          μ΄μ : 70μ             β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”                               β”‚
β”‚                                                      β”‚
β”‚  [μ·¨μ†]  [μ„μ‹μ €μ¥]  [λ―Έλ¦¬λ³΄κΈ°]  [λ°°ν¬]             β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
```

**κ²€μ¦**:
- [ ] ν‰κ°€ κΈ°λ³Έ μ •λ³΄ μ…λ ¥ κ°€λ¥
- [ ] λ¬Έν•­ κ²€μƒ‰ λ° ν•„ν„°λ§ λ™μ‘
- [ ] λ¬Έν•­ μ¶”κ°€/μ κ±° λ™μ‘
- [ ] λ“λκ·Έ μ•¤ λ“λ΅­μΌλ΅ μμ„ λ³€κ²½
- [ ] λ°°μ  μμ • κ°€λ¥
- [ ] λ―Έλ¦¬λ³΄κΈ° ν™”λ©΄ ν‘μ‹
- [ ] λ°°ν¬ μ‹ μƒνƒ λ³€κ²½ ν™•μΈ

---

#### 2.3 μ§„λ‹¨ ν‰κ°€ κ΄€λ¦¬ UI
**μ‘μ—… λ‚΄μ©**:
- μƒμ„±λ ν‰κ°€ λ©λ΅ ν‘μ‹
- μƒνƒλ³„/ν•™λ…„κµ°λ³„ ν•„ν„°λ§
- ν‰κ°€ μμ •/μ‚­μ 

**νμΌ**:
- `frontend/src/pages/DiagnosticAssessmentList.tsx`

**κ²€μ¦**:
- [ ] ν‰κ°€ λ©λ΅ μ΅°ν μ„±κ³µ
- [ ] ν•„ν„°λ§ λ™μ‘ ν™•μΈ
- [ ] ν‰κ°€ μμ •/μ‚­μ  λ™μ‘ ν™•μΈ

---

### Phase 3: ν•™μƒ ν‰κ°€ μ‘μ‹ κΈ°λ¥ (1μ£Όμ°¨)

#### 3.1 ν‰κ°€ μ‘μ‹ ν™”λ©΄
**μ‘μ—… λ‚΄μ©**:
- ν‰κ°€ μ‹μ‘ ν™”λ©΄
- λ¬Έν•­λ³„ μ‘λ‹µ ν™”λ©΄ (κ°κ΄€μ‹/μ„μ ν•)
- μ§„ν–‰λ¥  ν‘μ‹
- μ„μ‹ μ €μ¥ κΈ°λ¥
- μ μ¶ μ „ κ²€ν†  ν™”λ©΄

**νμΌ**:
- `frontend/src/pages/DiagnosticAssessmentTaking.tsx`
- `frontend/src/components/McqQuestion.tsx`
- `frontend/src/components/EssayQuestion.tsx`

**ν™”λ©΄ κµ¬μ„±**:
```
μƒλ‹¨: μ§„ν–‰λ¥  λ°” + νƒ€μ΄λ¨Έ

μΆμΈ΅/μƒλ‹¨: μ§€λ¬Έ μμ—­ (μ¤ν¬λ΅¤ κ°€λ¥)
μ°μΈ΅/ν•λ‹¨: λ¬Έν•­ μμ—­
  - κ°κ΄€μ‹: λΌλ””μ¤ λ²„νΌ
  - μ„μ ν•: ν…μ¤νΈ μ—μ–΄λ¦¬μ–΄

ν•λ‹¨: [μ΄μ „] [μ„μ‹μ €μ¥] [λ‹¤μ] [μ μ¶]
```

**κ²€μ¦**:
- [ ] ν‰κ°€ μ‹μ‘ μ‹ attempt μƒμ„±
- [ ] λ¬Έν•­ κ°„ μ΄λ™ λ™μ‘
- [ ] λ‹µμ• μ„μ‹ μ €μ¥ μ„±κ³µ
- [ ] κ°κ΄€μ‹ μ„ νƒ μ €μ¥
- [ ] μ„μ ν• ν…μ¤νΈ μ €μ¥
- [ ] μ μ¶ μ‹ μƒνƒ λ³€κ²½ (submitted)

---

#### 3.2 λ‹µμ• μ €μ¥ API
**μ‘μ—… λ‚΄μ©**:
- ν‰κ°€ μ‹μ‘ API
- λ‹µμ• μ„μ‹ μ €μ¥ API
- ν‰κ°€ μ μ¶ API

**νμΌ**:
- `frontend/src/services/diagnosticAssessmentService.ts`

**μ£Όμ” ν•¨μ**:
```typescript
- startAssessment(assessmentId: number)
- saveResponse(attemptId: number, responses: StudentResponse[])
- submitAssessment(attemptId: number)
```

**κ²€μ¦**:
- [ ] ν‰κ°€ μ‹μ‘ μ‹ attempt μƒμ„±
- [ ] λ‹µμ• μ €μ¥ μ„±κ³µ
- [ ] μ μ¶ μ‹ μƒνƒ λ³€κ²½ λ° μ±„μ  νΈλ¦¬κ±°

---

### Phase 4: μλ™ μ±„μ  μ‹μ¤ν… (1.5μ£Όμ°¨)

#### 4.1 κ°κ΄€μ‹ μλ™ μ±„μ 
**μ‘μ—… λ‚΄μ©**:
- μ μ¶ μ‹ κ°κ΄€μ‹ μλ™ μ±„μ 
- μ •λ‹µ μ—¬λ¶€ νμ •
- μ μ κ³„μ‚°

**νμΌ**:
- `frontend/src/services/gradingService.ts`

**ν•¨μ**:
```typescript
async function gradeMultipleChoice(attemptId: number) {
  // 1. ν•΄λ‹Ή attemptμ λ¨λ“  κ°κ΄€μ‹ μ‘λ‹µ μ΅°ν
  // 2. κ° μ‘λ‹µμ μ •λ‹µ μ—¬λ¶€ ν™•μΈ (items ν…μ΄λΈ”μ μ •λ‹µκ³Ό λΉ„κµ)
  // 3. student_responses ν…μ΄λΈ”μ is_correct, score μ—…λ°μ΄νΈ
  // 4. attemptμ total_score μ—…λ°μ΄νΈ
}
```

**κ²€μ¦**:
- [ ] κ°κ΄€μ‹ μ •λ‹µ νμ • μ •ν™•λ„ 100%
- [ ] μ μ κ³„μ‚° μ •ν™•λ„ 100%
- [ ] total_score μ—…λ°μ΄νΈ ν™•μΈ

---

#### 4.2 μ„μ ν• AI μ±„μ 
**μ‘μ—… λ‚΄μ©**:
- OpenAI APIλ¥Ό ν™μ©ν• λ£¨λΈλ¦­ κΈ°λ° μ±„μ 
- μμ—­λ³„ μμ¤€ νμ • (μƒ/μ¤‘/ν•)
- μ μ κ³„μ‚° λ° ν”Όλ“λ°± μƒμ„±

**νμΌ**:
- `frontend/src/services/essayGradingService.ts`

**ν•¨μ**:
```typescript
interface EssayGradingRequest {
  stem: string;               // λ¬Έν•­ λ°λ¬Έ
  rubric: RubricCriterion[];  // λ£¨λΈλ¦­
  essayText: string;          // ν•™μƒ λ‹µμ•
  maxScore: number;           // λ°°μ 
}

async function gradeEssay(request: EssayGradingRequest): Promise<EssayGradingResult> {
  // 1. μ‹μ¤ν… ν”„λ΅¬ν”„νΈ μƒμ„±
  const systemPrompt = `
λ‹Ήμ‹ μ€ ν•™μƒμ μ„μ ν• λ‹µμ•μ„ μ±„μ ν•λ” μ „λ¬Έ ν‰κ°€μμ…λ‹λ‹¤.
μ κ³µλ λ£¨λΈλ¦­μ— λ”°λΌ λ‹µμ•μ„ ν‰κ°€ν•κ³ , κ° μμ—­λ³„λ΅ μƒ/μ¤‘/ν• μμ¤€μ„ νμ •ν•μ„Έμ”.
  `;

  // 2. μ‚¬μ©μ ν”„λ΅¬ν”„νΈ μƒμ„±
  const userPrompt = `
## λ¬Έν•­
${request.stem}

## ν•™μƒ λ‹µμ•
${request.essayText}

## ν‰κ°€ λ£¨λΈλ¦­
${request.rubric.map(r => `
- ${r.area} (${r.weight}%)
  - μƒ: ${r.high}
  - μ¤‘: ${r.middle}
  - ν•: ${r.low}
`).join('\n')}

## μ”μ²­μ‚¬ν•­
1. κ° ν‰κ°€ μμ—­λ³„λ΅ μƒ/μ¤‘/ν• μμ¤€μ„ νμ •ν•μ„Έμ”
2. κ° μμ—­λ³„ μ μλ¥Ό κ³„μ‚°ν•μ„Έμ”
   - μƒ = μμ—­ λ°°μ μ 100%
   - μ¤‘ = μμ—­ λ°°μ μ 70%
   - ν• = μμ—­ λ°°μ μ 40%
3. κ° μμ—­λ³„λ΅ κµ¬μ²΄μ μΈ ν”Όλ“λ°±μ„ 20-30μλ΅ μ‘μ„±ν•μ„Έμ”
4. μ „μ²΄μ μΈ μΆ…ν•© ν”Όλ“λ°±μ„ 50μ μ΄λ‚΄λ΅ μ‘μ„±ν•μ„Έμ”

μ‘λ‹µμ€ JSON ν•μ‹μΌλ΅ μ κ³µν•μ„Έμ”.
  `;

  // 3. OpenAI API νΈμ¶
  const response = await fetch('https://api.openai.com/v1/chat/completions', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'Authorization': `Bearer ${OPENAI_API_KEY}`,
    },
    body: JSON.stringify({
      model: 'gpt-4-turbo-preview',
      messages: [
        { role: 'system', content: systemPrompt },
        { role: 'user', content: userPrompt },
      ],
      response_format: { type: 'json_object' },
      temperature: 0.3,
    }),
  });

  // 4. μ‘λ‹µ νμ‹±
  const data = await response.json();
  const result = JSON.parse(data.choices[0].message.content);

  // 5. κ²°κ³Ό λ°ν™
  return {
    criteria_scores: result.criteria_scores,
    total_score: result.total_score,
    overall_feedback: result.overall_feedback,
  };
}
```

**κ²€μ¦**:
- [ ] AI μ±„μ  μ‘λ‹µ μμ‹  μ„±κ³µ
- [ ] JSON νμ‹± μ„±κ³µ
- [ ] λ£¨λΈλ¦­ κΈ°μ¤€μ— λ”°λ¥Έ μ μ κ³„μ‚° μ •ν™•μ„±
- [ ] ν”Όλ“λ°± ν’μ§ ν™•μΈ (κµμ‚¬ μƒν” ν‰κ°€μ™€ λΉ„κµ)
- [ ] essay_gradings ν…μ΄λΈ” μ €μ¥ ν™•μΈ

---

#### 4.3 μ±„μ  ν†µν•© API
**μ‘μ—… λ‚΄μ©**:
- ν‰κ°€ μ μ¶ μ‹ κ°κ΄€μ‹ + μ„μ ν• μλ™ μ±„μ 
- μ „μ²΄ μ μ κ³„μ‚° λ° μ—…λ°μ΄νΈ

**ν•¨μ**:
```typescript
async function gradeAssessment(attemptId: number) {
  // 1. κ°κ΄€μ‹ μ±„μ 
  await gradeMultipleChoice(attemptId);

  // 2. μ„μ ν• μ±„μ  (λ³‘λ ¬ μ²λ¦¬)
  const essayResponses = await getEssayResponses(attemptId);
  const essayGradings = await Promise.all(
    essayResponses.map(response => gradeEssay({
      stem: response.item.stem,
      rubric: response.item.rubric,
      essayText: response.essay_text,
      maxScore: response.points,
    }))
  );

  // 3. μ„μ ν• μ±„μ  κ²°κ³Ό μ €μ¥
  for (let i = 0; i < essayResponses.length; i++) {
    await saveEssayGrading(essayResponses[i].response_id, essayGradings[i]);
  }

  // 4. μ „μ²΄ μ μ κ³„μ‚° λ° μ—…λ°μ΄νΈ
  const totalScore = await calculateTotalScore(attemptId);
  await updateAttemptScore(attemptId, totalScore);

  // 5. μƒνƒ λ³€κ²½ (submitted β†’ graded)
  await updateAttemptStatus(attemptId, 'graded');
}
```

**κ²€μ¦**:
- [ ] κ°κ΄€μ‹ + μ„μ ν• ν†µν•© μ±„μ  μ„±κ³µ
- [ ] μ „μ²΄ μ μ κ³„μ‚° μ •ν™•μ„±
- [ ] μƒνƒ λ³€κ²½ ν™•μΈ

---

### Phase 5: μ§„λ‹¨ λ³΄κ³ μ„ μƒμ„± (1.5μ£Όμ°¨)

#### 5.1 λ³΄κ³ μ„ λ°μ΄ν„° μƒμ„±
**μ‘μ—… λ‚΄μ©**:
- μμ—­λ³„ μ μ μ§‘κ³„
- λ“±κΈ‰ μ‚°μ¶ (A+, A, B+, B, C+, C, D, F)
- κ°•μ /μ•½μ  λ¶„μ„
- μΆ…ν•© ν”Όλ“λ°± μƒμ„±
- ν•™μµ μ¶”μ² μƒμ„±

**νμΌ**:
- `frontend/src/services/reportGenerationService.ts`

**ν•¨μ**:
```typescript
async function generateDiagnosticReport(attemptId: number): Promise<DiagnosticReport> {
  // 1. μ±„μ  κ²°κ³Ό μ΅°ν
  const attempt = await getAttemptWithScores(attemptId);

  // 2. μμ—­λ³„ μ μ μ§‘κ³„
  const areaScores = await aggregateAreaScores(attemptId);

  // 3. λ“±κΈ‰ μ‚°μ¶
  const percentage = (attempt.total_score / attempt.max_score) * 100;
  const grade = calculateGrade(percentage);

  // 4. κ°•μ /μ•½μ  λ¶„μ„
  const { strengths, weaknesses } = analyzeStrengthsWeaknesses(areaScores);

  // 5. μΆ…ν•© ν”Όλ“λ°± μƒμ„± (AI)
  const comprehensiveFeedback = await generateComprehensiveFeedback({
    totalScore: attempt.total_score,
    maxScore: attempt.max_score,
    grade,
    areaScores,
    strengths,
    weaknesses,
  });

  // 6. ν•™μµ μ¶”μ² (μ•½μ  μμ—­ κΈ°λ°)
  const recommendedBooks = await recommendBooks(weaknesses);
  const improvementSuggestions = generateImprovementSuggestions(weaknesses);

  // 7. λ³΄κ³ μ„ μ €μ¥
  const report = {
    attempt_id: attemptId,
    student_id: attempt.student_id,
    assessment_id: attempt.assessment_id,
    total_score: attempt.total_score,
    max_score: attempt.max_score,
    percentage,
    grade,
    area_scores: areaScores,
    strengths,
    weaknesses,
    comprehensive_feedback: comprehensiveFeedback,
    detailed_feedback: '', // Phase 2μ—μ„ μ¶”κ°€
    recommended_books: recommendedBooks,
    improvement_suggestions: improvementSuggestions,
  };

  await saveReport(report);
  return report;
}

function calculateGrade(percentage: number): string {
  if (percentage >= 95) return 'A+';
  if (percentage >= 90) return 'A';
  if (percentage >= 85) return 'B+';
  if (percentage >= 80) return 'B';
  if (percentage >= 75) return 'C+';
  if (percentage >= 70) return 'C';
  if (percentage >= 60) return 'D';
  return 'F';
}
```

**κ²€μ¦**:
- [ ] μμ—­λ³„ μ μ μ§‘κ³„ μ •ν™•μ„±
- [ ] λ“±κΈ‰ μ‚°μ¶ μ •ν™•μ„±
- [ ] κ°•μ /μ•½μ  λ¶„μ„ νƒ€λ‹Ήμ„±
- [ ] AI ν”Όλ“λ°± ν’μ§
- [ ] λ³΄κ³ μ„ μ €μ¥ μ„±κ³µ

---

#### 5.2 λ³΄κ³ μ„ UI (Legacy μ–‘μ‹ κΈ°λ°)
**μ‘μ—… λ‚΄μ©**:
- μΆ…ν•© ν‰κ°€ ν—¤λ” (κ·ΈλΌλ°μ΄μ… λ°°κ²½)
- μμ—­λ³„ μ μ (λ§‰λ€ κ·Έλν”„ + λ μ΄λ” μ°¨νΈ)
- κ°•μ  λ° μ•½μ  μΉ΄λ“
- μƒμ„Έ ν”Όλ“λ°±
- ν•™μµ μ¶”μ²

**νμΌ**:
- `frontend/src/pages/DiagnosticReport.tsx`
- `frontend/src/components/ReportHeader.tsx`
- `frontend/src/components/AreaScoresChart.tsx`
- `frontend/src/components/StrengthsWeaknesses.tsx`

**ν™”λ©΄ κµ¬μ„±** (Legacyμ EvaluationResult.tsx μ°Έκ³ ):
```
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚  ν‰κ°€ κ²°κ³Ό λ¦¬ν¬νΈ                                    β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”  β”‚
β”‚  β”‚ [κ·ΈλΌλ°μ΄μ… λ°°κ²½]                              β”‚  β”‚
β”‚  β”‚   π†                                           β”‚  β”‚
β”‚  β”‚   85μ                                          β”‚  β”‚
β”‚  β”‚   [B+]                                         β”‚  β”‚
β”‚  β”‚                                                β”‚  β”‚
β”‚  β”‚   μΆ…ν•© ν‰κ°€:                                   β”‚  β”‚
β”‚  β”‚   μ „λ°μ μΌλ΅ μ°μν• λ…μ„ λ¥λ ¥μ„ λ³΄μ€μµλ‹λ‹¤...   β”‚  β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”  β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚  μμ—­λ³„ μ μ                    μμ—­λ³„ μ μ μ°¨νΈ     β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”            β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”  β”‚
β”‚  β”‚ μ‚¬μ‹¤μ  μ΄ν•΄    β”‚            β”‚  [λ μ΄λ”μ°¨νΈ]  β”‚  β”‚
β”‚  β”‚ [β–β–β–β–β–β–β–β–β–‘β–‘] 18/20         β”‚                β”‚  β”‚
β”‚  β”‚                β”‚            β”‚                β”‚  β”‚
β”‚  β”‚ μ¶”λ΅ μ  μ΄ν•΄    β”‚            β”‚                β”‚  β”‚
β”‚  β”‚ [β–β–β–β–β–β–β–β–‘β–‘β–‘] 14/20         β”‚                β”‚  β”‚
β”‚  β”‚                β”‚            β”‚                β”‚  β”‚
β”‚  β”‚ λΉ„νμ  μ΄ν•΄    β”‚            β”‚                β”‚  β”‚
β”‚  β”‚ [β–β–β–β–β–β–β–‘β–‘β–‘β–‘] 12/20         β”‚                β”‚  β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”            β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”  β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚  κ°•μ                            κ°μ„  ν•„μ”            β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”            β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”  β”‚
β”‚  β”‚ β“ μ‚¬μ‹¤ μ •λ³΄λ¥Ό  β”‚            β”‚ β  λΉ„νμ  λ¶„μ„  β”‚  β”‚
β”‚  β”‚   μ •ν™•ν νμ•…  β”‚            β”‚   λ¥λ ¥ λ³΄μ™„    β”‚  β”‚
β”‚  β”‚                β”‚            β”‚                β”‚  β”‚
β”‚  β”‚ β“ ν’λ¶€ν• μ–΄ν  β”‚            β”‚ β  λ…Όλ¦¬μ  μ¶”λ΅   β”‚  β”‚
β”‚  β”‚   μ‚¬μ©         β”‚            β”‚   μ—°μµ ν•„μ”    β”‚  β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”            β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”  β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚  ν•™μµ μ¶”μ²                                           β”‚
β”‚  - μ¶”μ² λ„μ„: [λ„μ„1], [λ„μ„2], [λ„μ„3]             β”‚
β”‚  - κ°μ„  μ μ•: ...                                    β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
```

**κ²€μ¦**:
- [ ] λ³΄κ³ μ„ λ°μ΄ν„° λ΅λ“ μ„±κ³µ
- [ ] μ°¨νΈ λ λ”λ§ μ„±κ³µ
- [ ] κ°•μ /μ•½μ  μΉ΄λ“ ν‘μ‹
- [ ] ν•™μµ μ¶”μ² ν‘μ‹
- [ ] λ°μ‘ν• λ μ΄μ•„μ›ƒ λ™μ‘

---

### Phase 6: ν†µν•© ν…μ¤νΈ λ° μµμ ν™” (1μ£Όμ°¨)

#### 6.1 E2E ν…μ¤νΈ
**ν…μ¤νΈ μ‹λ‚λ¦¬μ¤**:
1. κµμ‚¬κ°€ μ§„λ‹¨ ν‰κ°€ μƒμ„±
2. ν•™μƒμ΄ ν‰κ°€ μ‘μ‹ (κ°κ΄€μ‹ + μ„μ ν•)
3. μλ™ μ±„μ  μ‹¤ν–‰
4. λ³΄κ³ μ„ μƒμ„± λ° ν™•μΈ

**κ²€μ¦ ν•­λ©**:
- [ ] μ „μ²΄ ν”λ΅μ° μ •μƒ λ™μ‘
- [ ] λ°μ΄ν„° μΌκ΄€μ„± ν™•μΈ
- [ ] μ—λ¬ ν•Έλ“¤λ§ ν™•μΈ

---

#### 6.2 μ„±λ¥ μµμ ν™”
**μ‘μ—… λ‚΄μ©**:
- API μ‘λ‹µ μ‹κ°„ μΈ΅μ • λ° μµμ ν™”
- μ„μ ν• μ±„μ  λ³‘λ ¬ μ²λ¦¬
- λ³΄κ³ μ„ μƒμ„± μΊμ‹±
- λ°μ΄ν„°λ² μ΄μ¤ μΏΌλ¦¬ μµμ ν™”

**λ©ν‘**:
- κ°κ΄€μ‹ μ±„μ : 1μ΄ μ΄λ‚΄
- μ„μ ν• μ±„μ  (1λ¬Έν•­): 5μ΄ μ΄λ‚΄
- λ³΄κ³ μ„ μƒμ„±: 30μ΄ μ΄λ‚΄

**κ²€μ¦**:
- [ ] μ„±λ¥ λ©ν‘ λ‹¬μ„±
- [ ] λ™μ‹ μ ‘μ†μ 10λ… μ²λ¦¬ κ°€λ¥

---

#### 6.3 UI/UX κ°μ„ 
**μ‘μ—… λ‚΄μ©**:
- λ΅λ”© μƒνƒ ν‘μ‹ κ°μ„ 
- μ—λ¬ λ©”μ‹μ§€ μ‚¬μ©μ μΉν™”μ μΌλ΅ κ°μ„ 
- μ ‘κ·Όμ„± κ²€ν†  (ARIA μ†μ„±, ν‚¤λ³΄λ“ λ„¤λΉ„κ²μ΄μ…)

**κ²€μ¦**:
- [ ] λ΅λ”© μΈλ””μΌ€μ΄ν„° μ μ ν ν‘μ‹
- [ ] μ—λ¬ λ°μƒ μ‹ λ…ν™•ν• μ•λ‚΄
- [ ] ν‚¤λ³΄λ“λ΅ λ¨λ“  κΈ°λ¥ μ‚¬μ© κ°€λ¥

---

## 3. νμΌ κµ¬μ΅°

```
frontend/src/
β”β”€β”€ pages/
β”‚   β”β”€β”€ DiagnosticAssessmentCreate.tsx        # μ§„λ‹¨ ν‰κ°€ μƒμ„±
β”‚   β”β”€β”€ DiagnosticAssessmentList.tsx          # μ§„λ‹¨ ν‰κ°€ λ©λ΅
β”‚   β”β”€β”€ DiagnosticAssessmentTaking.tsx        # ν‰κ°€ μ‘μ‹
β”‚   β””β”€β”€ DiagnosticReport.tsx                  # μ§„λ‹¨ λ³΄κ³ μ„
β”β”€β”€ components/
β”‚   β”β”€β”€ ItemSelector.tsx                      # λ¬Έν•­ μ„ νƒκΈ°
β”‚   β”β”€β”€ SelectedItemsList.tsx                 # μ„ νƒλ λ¬Έν•­ λ©λ΅
β”‚   β”β”€β”€ McqQuestion.tsx                       # κ°κ΄€μ‹ λ¬Έν•­
β”‚   β”β”€β”€ EssayQuestion.tsx                     # μ„μ ν• λ¬Έν•­
β”‚   β”β”€β”€ ReportHeader.tsx                      # λ³΄κ³ μ„ ν—¤λ”
β”‚   β”β”€β”€ AreaScoresChart.tsx                   # μμ—­λ³„ μ μ μ°¨νΈ
β”‚   β””β”€β”€ StrengthsWeaknesses.tsx               # κ°•μ /μ•½μ  μΉ΄λ“
β”β”€β”€ services/
β”‚   β”β”€β”€ diagnosticAssessmentService.ts        # μ§„λ‹¨ ν‰κ°€ API
β”‚   β”β”€β”€ gradingService.ts                     # μ±„μ  μ„λΉ„μ¤
β”‚   β”β”€β”€ essayGradingService.ts                # μ„μ ν• AI μ±„μ 
β”‚   β””β”€β”€ reportGenerationService.ts            # λ³΄κ³ μ„ μƒμ„±
β””β”€β”€ types/
    β””β”€β”€ diagnosticAssessment.ts               # νƒ€μ… μ •μ

supabase/
β””β”€β”€ diagnostic_assessment_schema.sql          # DB μ¤ν‚¤λ§
```

---

## 4. μ²΄ν¬λ¦¬μ¤νΈ

### Phase 1: λ°μ΄ν„°λ² μ΄μ¤ λ° κΈ°λ³Έ μΈν”„λΌ
- [ ] λ°μ΄ν„°λ² μ΄μ¤ μ¤ν‚¤λ§ μƒμ„± μ™„λ£
- [ ] RLS μ •μ±… μ„¤μ • μ™„λ£
- [ ] TypeScript νƒ€μ… μ •μ μ™„λ£
- [ ] Supabase ν΄λΌμ΄μ–ΈνΈ ν—¬νΌ ν•¨μ μ‘μ„± μ™„λ£

### Phase 2: μ§„λ‹¨ ν‰κ°€ μƒμ„± κΈ°λ¥
- [ ] ν‰κ°€ CRUD API κµ¬ν„ μ™„λ£
- [ ] μ§„λ‹¨ ν‰κ°€ μƒμ„± UI μ™„λ£
- [ ] λ¬Έν•­ μ„ νƒ λ° μ¶”κ°€ κΈ°λ¥ μ™„λ£
- [ ] ν‰κ°€ λ°°ν¬ κΈ°λ¥ μ™„λ£
- [ ] μ§„λ‹¨ ν‰κ°€ κ΄€λ¦¬ UI μ™„λ£

### Phase 3: ν•™μƒ ν‰κ°€ μ‘μ‹ κΈ°λ¥
- [ ] ν‰κ°€ μ‹μ‘ API μ™„λ£
- [ ] λ‹µμ• μ €μ¥ API μ™„λ£
- [ ] ν‰κ°€ μ‘μ‹ UI μ™„λ£
- [ ] μ„μ‹ μ €μ¥ κΈ°λ¥ μ™„λ£
- [ ] μ μ¶ κΈ°λ¥ μ™„λ£

### Phase 4: μλ™ μ±„μ  μ‹μ¤ν…
- [ ] κ°κ΄€μ‹ μλ™ μ±„μ  μ™„λ£
- [ ] μ„μ ν• AI μ±„μ  μ™„λ£
- [ ] μ±„μ  ν†µν•© API μ™„λ£
- [ ] μ μ κ³„μ‚° λ° μ—…λ°μ΄νΈ μ™„λ£

### Phase 5: μ§„λ‹¨ λ³΄κ³ μ„ μƒμ„±
- [ ] μμ—­λ³„ μ μ μ§‘κ³„ μ™„λ£
- [ ] λ“±κΈ‰ μ‚°μ¶ μ™„λ£
- [ ] κ°•μ /μ•½μ  λ¶„μ„ μ™„λ£
- [ ] μΆ…ν•© ν”Όλ“λ°± μƒμ„± μ™„λ£
- [ ] ν•™μµ μ¶”μ² μƒμ„± μ™„λ£
- [ ] λ³΄κ³ μ„ UI μ™„λ£ (Legacy μ–‘μ‹ κΈ°λ°)

### Phase 6: ν†µν•© ν…μ¤νΈ λ° μµμ ν™”
- [ ] E2E ν…μ¤νΈ μ™„λ£
- [ ] μ„±λ¥ μµμ ν™” μ™„λ£
- [ ] UI/UX κ°μ„  μ™„λ£
- [ ] μ ‘κ·Όμ„± κ²€ν†  μ™„λ£

---

## 5. λ¦¬μ¤ν¬ λ° λ€μ‘ λ°©μ•

### 5.1 κΈ°μ μ  λ¦¬μ¤ν¬
| λ¦¬μ¤ν¬ | μν–¥λ„ | λ€μ‘ λ°©μ• |
|--------|--------|-----------|
| OpenAI API μ‘λ‹µ μ§€μ—° | μ¤‘ | νƒ€μ„μ•„μ›ƒ μ„¤μ •, μ¬μ‹λ„ λ΅μ§, μ‚¬μ©μ μ•λ‚΄ |
| OpenAI API λΉ„μ© μ΄κ³Ό | μ¤‘ | μΌμΌ μ‚¬μ©λ‰ μ ν•, μΊμ‹±, λ°°μΉ μ²λ¦¬ |
| AI μ±„μ  ν’μ§ λ¬Έμ  | λ†’μ | κµμ‚¬ μ¬μ±„μ  κΈ°λ¥, μƒν” ν‰κ°€ ν›„ ν”„λ΅¬ν”„νΈ κ°μ„  |
| λ™μ‹ μ ‘μ†μ ν­μ£Ό | μ¤‘ | μ‘μ‹ μ‹κ°„ λ¶„μ‚°, λ΅λ“ λ°Έλ°μ‹± |

### 5.2 μΌμ • λ¦¬μ¤ν¬
| λ¦¬μ¤ν¬ | μν–¥λ„ | λ€μ‘ λ°©μ• |
|--------|--------|-----------|
| AI μ±„μ  ν”„λ΅¬ν”„νΈ μ΅°μ • μ‹κ°„ | μ¤‘ | Phase 4μ— μ¶©λ¶„ν• λ²„νΌ μ‹κ°„ ν™•λ³΄ |
| UI λ””μμΈ λ°λ³µ | λ‚®μ | Legacy μ–‘μ‹ μ κ·Ή ν™μ© |
| ν†µν•© ν…μ¤νΈ λ²„κ·Έ | μ¤‘ | Phase 6μ— μ¶©λ¶„ν• μ‹κ°„ ν• λ‹Ή |

---

## 6. λ‹¤μ λ‹¨κ³„ (Phase 7+)

### 6.1 P1 κΈ°λ¥ (μ¤‘μ”)
- κµμ‚¬μ μ„μ ν• μλ™ μ±„μ  λ° μ μ μ΅°μ •
- ν•™λ¶€λ¨ λ³΄κ³ μ„ μ—΄λ νμ΄μ§€
- λ³΄κ³ μ„ PDF λ‚΄λ³΄λ‚΄κΈ°
- λ¬Έν•­λ³„ μ •λ‹µλ¥  λ° λ³€λ³„λ„ λ¶„μ„

### 6.2 P2 κΈ°λ¥ (μ„ νƒ)
- ν•™μƒλ³„ μ„±μ¥ μ¶”μ  (μ—¬λ¬ μ§„λ‹¨ ν‰κ°€ λΉ„κµ)
- ν•™κΈ‰ λ‹¨μ„ λ¶„μ„ λ€μ‹λ³΄λ“
- λ¬Έν•­ μλ™ μ¶”μ² (AI κΈ°λ°)
- μ μ‘ν• ν‰κ°€ (ν•™μƒ μμ¤€μ— λ”°λΌ λ‚μ΄λ„ μ΅°μ •)

---

## 7. μ°Έκ³  μλ£
- PRD: `docs/PRD_Diagnostic_Assessment_System.md`
- Legacy λ³΄κ³ μ„ UI: `legacy/frontend/src/pages/EvaluationResult.tsx`
- ν„μ¬ λ£¨λΈλ¦­ μ‹μ¤ν…: `frontend/src/services/openaiService.ts`
- Supabase λ¬Έμ„: https://supabase.com/docs
- OpenAI API λ¬Έμ„: https://platform.openai.com/docs
